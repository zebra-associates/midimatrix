<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns = "http://www.w3.org/1999/xhtml">
<head>
 <meta http-equiv="content-type" content="text/html; charset=utf-8" />
 <!-- midi.js package -->
 <script src="./midi.js/js/MIDI/AudioDetect.js" type="text/javascript"></script>
 <script src="./midi.js/js/MIDI/LoadPlugin.js" type="text/javascript"></script>
 <script src="./midi.js/js/MIDI/Plugin.js" type="text/javascript"></script>
 <script src="./midi.js/js/MIDI/Player.js" type="text/javascript"></script>
 <script src="./midi.js/js/Window/DOMLoader.XMLHttp.js" type="text/javascript"></script>
 <script src="./midi.js/js/Window/DOMLoader.script.js" type="text/javascript"></script>
 <!-- extras -->
 <script src="./midi.js/inc/WebMIDIAPI.js" type="text/javascript"></script>
 <script src="./midi.js/inc/Base64.js" type="text/javascript"></script>
 <script src="./midi.js/inc/base64binary.js" type="text/javascript"></script>
 <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
 <style type="text/css">
   td {
     width: 35px;
     height: 35px;
     border: 1px solid black;
     background-color: lightgray;
   }
   td.active {
     background-color: green;
   }
 </style>
</head>
<body>
<script type="text/javascript">

window.onload = function () {
  window.play = function(n) {
    var notes = $("td.active:nth-child("+n+")").map(function() { return $(this).parent().data("note"); });
    for( var i=0; i<notes.length; ++i ) {
      MIDI.noteOn(0, notes[i], 127, 0);
      MIDI.noteOff(0, notes[i], 127, 0.75);
    }
  };
  $("table td").click(function() {
    $(this).toggleClass("active");
  });
  MIDI.loadPlugin({
    soundfontUrl: "./midi.js/soundfont/",
    instrument: "acoustic_grand_piano",
    callback: function() {
      currentTime = 1;				  
      window.setInterval(function() { 
        play(currentTime); 
        currentTime += 1; 
        if( currentTime > 3 ) currentTime = 1;
      }, 750);
    }
  });
};

</script>

<table>
  <tr data-note="50">
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
  </tr>
  <tr data-note="51">
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
  </tr>
  <tr data-note="52">
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
  </tr>
  <tr data-note="53">
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
  </tr>
  <tr data-note="54">
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
  </tr>
  <tr data-note="55">
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
  </tr>
  <tr data-note="56">
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
  </tr>
  <tr data-note="57">
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
  </tr>
  <tr data-note="58">
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
  </tr>
  <tr data-note="59">
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
  </tr>
  <tr data-note="60">
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
  </tr>
  <tr data-note="61">
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
  </tr>
  <tr data-note="62">
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
  </tr>

</table>
</body>
</html>
